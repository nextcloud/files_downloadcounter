{"version":3,"file":"files_downloadlimit-public.mjs","sources":["../node_modules/escape-html/index.js","../node_modules/@nextcloud/initial-state/dist/index.es.mjs","../node_modules/@nextcloud/l10n/dist/index.mjs","../src/public.ts"],"sourcesContent":["/*!\n * escape-html\n * Copyright(c) 2012-2013 TJ Holowaychuk\n * Copyright(c) 2015 Andreas Lubbe\n * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module variables.\n * @private\n */\n\nvar matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = escapeHtml;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nfunction escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n\n  if (!match) {\n    return str;\n  }\n\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34: // \"\n        escape = '&quot;';\n        break;\n      case 38: // &\n        escape = '&amp;';\n        break;\n      case 39: // '\n        escape = '&#39;';\n        break;\n      case 60: // <\n        escape = '&lt;';\n        break;\n      case 62: // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n\n    lastIndex = index + 1;\n    html += escape;\n  }\n\n  return lastIndex !== index\n    ? html + str.substring(lastIndex, index)\n    : html;\n}\n","/**\n * @param app app ID, e.g. \"mail\"\n * @param key name of the property\n * @param fallback optional parameter to use as default value\n * @throws if the key can't be found\n */\nfunction loadState(app, key, fallback) {\n    const elem = document.querySelector(`#initial-state-${app}-${key}`);\n    if (elem === null) {\n        if (fallback !== undefined) {\n            return fallback;\n        }\n        throw new Error(`Could not find initial state ${key} of ${app}`);\n    }\n    try {\n        return JSON.parse(atob(elem.value));\n    }\n    catch (e) {\n        throw new Error(`Could not parse initial state ${key} of ${app}`);\n    }\n}\n\nexport { loadState };\n//# sourceMappingURL=index.es.mjs.map\n","import { generateFilePath } from '@nextcloud/router';\nimport DOMPurify from 'dompurify';\nimport escapeHTML from 'escape-html';\n\n/// <reference types=\"@nextcloud/typings\" />\n/**\n * Get the first day of the week\n *\n * @return {number}\n */\nfunction getFirstDay() {\n    if (typeof window.firstDay === 'undefined') {\n        console.warn('No firstDay found');\n        return 1;\n    }\n    return window.firstDay;\n}\n/**\n * Get a list of day names (full names)\n *\n * @return {string[]}\n */\nfunction getDayNames() {\n    if (typeof window.dayNames === 'undefined') {\n        console.warn('No dayNames found');\n        return [\n            'Sunday',\n            'Monday',\n            'Tuesday',\n            'Wednesday',\n            'Thursday',\n            'Friday',\n            'Saturday',\n        ];\n    }\n    return window.dayNames;\n}\n/**\n * Get a list of day names (short names)\n *\n * @return {string[]}\n */\nfunction getDayNamesShort() {\n    if (typeof window.dayNamesShort === 'undefined') {\n        console.warn('No dayNamesShort found');\n        return ['Sun.', 'Mon.', 'Tue.', 'Wed.', 'Thu.', 'Fri.', 'Sat.'];\n    }\n    return window.dayNamesShort;\n}\n/**\n * Get a list of day names (minified names)\n *\n * @return {string[]}\n */\nfunction getDayNamesMin() {\n    if (typeof window.dayNamesMin === 'undefined') {\n        console.warn('No dayNamesMin found');\n        return ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\n    }\n    return window.dayNamesMin;\n}\n/**\n * Get a list of month names (full names)\n *\n * @return {string[]}\n */\nfunction getMonthNames() {\n    if (typeof window.monthNames === 'undefined') {\n        console.warn('No monthNames found');\n        return [\n            'January',\n            'February',\n            'March',\n            'April',\n            'May',\n            'June',\n            'July',\n            'August',\n            'September',\n            'October',\n            'November',\n            'December',\n        ];\n    }\n    return window.monthNames;\n}\n/**\n * Get a list of month names (short names)\n *\n * @return {string[]}\n */\nfunction getMonthNamesShort() {\n    if (typeof window.monthNamesShort === 'undefined') {\n        console.warn('No monthNamesShort found');\n        return [\n            'Jan.',\n            'Feb.',\n            'Mar.',\n            'Apr.',\n            'May.',\n            'Jun.',\n            'Jul.',\n            'Aug.',\n            'Sep.',\n            'Oct.',\n            'Nov.',\n            'Dec.',\n        ];\n    }\n    return window.monthNamesShort;\n}\n\n/**\n * Returns the user's locale\n */\nfunction getLocale() {\n    return document.documentElement.dataset.locale || 'en';\n}\n/**\n * Returns user's locale in canonical form\n * E.g. `en-US` instead of `en_US`\n */\nfunction getCanonicalLocale() {\n    return getLocale().replace(/_/g, '-');\n}\n/**\n * Returns the user's language\n */\nfunction getLanguage() {\n    return document.documentElement.lang || 'en';\n}\n/**\n * Check whether the current, or a given, language is read right-to-left\n *\n * @param language Language code to check, defaults to current language\n */\nfunction isRTL(language) {\n    const languageCode = language || getLanguage();\n    // Source: https://meta.wikimedia.org/wiki/Template:List_of_language_names_ordered_by_code\n    const rtlLanguages = [\n        /* eslint-disable no-multi-spaces */\n        'ae',\n        'ar',\n        'arc',\n        'arz',\n        'bcc',\n        'bqi',\n        'ckb',\n        'dv',\n        'fa',\n        'glk',\n        'ha',\n        'he',\n        'khw',\n        'ks',\n        'ku',\n        'mzn',\n        'nqo',\n        'pnb',\n        'ps',\n        'sd',\n        'ug',\n        'ur',\n        'uzs',\n        'yi', // 'ייִדיש', Yiddish\n        /* eslint-enable no-multi-spaces */\n    ];\n    // special case for Uzbek Afghan\n    if ((language || getCanonicalLocale()).startsWith('uz-AF')) {\n        return true;\n    }\n    return rtlLanguages.includes(languageCode);\n}\n\n/// <reference types=\"@nextcloud/typings\" />\n/**\n * Check if translations and plural function are set for given app\n *\n * @param {string} appId the app id\n * @return {boolean}\n */\nfunction hasAppTranslations(appId) {\n    var _a, _b;\n    return (((_a = window._oc_l10n_registry_translations) === null || _a === void 0 ? void 0 : _a[appId]) !== undefined\n        && ((_b = window._oc_l10n_registry_plural_functions) === null || _b === void 0 ? void 0 : _b[appId]) !== undefined);\n}\n/**\n * Register new, or extend available, translations for an app\n *\n * @param {string} appId the app id\n * @param {object} translations the translations list\n * @param {Function} pluralFunction the plural function\n */\nfunction registerAppTranslations(appId, translations, pluralFunction) {\n    var _a;\n    window._oc_l10n_registry_translations = Object.assign(window._oc_l10n_registry_translations || {}, {\n        [appId]: Object.assign(((_a = window._oc_l10n_registry_translations) === null || _a === void 0 ? void 0 : _a[appId]) || {}, translations),\n    });\n    window._oc_l10n_registry_plural_functions = Object.assign(window._oc_l10n_registry_plural_functions || {}, {\n        [appId]: pluralFunction,\n    });\n}\n/**\n * Unregister all translations and plural function for given app\n *\n * @param {string} appId the app id\n */\nfunction unregisterAppTranslations(appId) {\n    var _a, _b;\n    (_a = window._oc_l10n_registry_translations) === null || _a === void 0 ? true : delete _a[appId];\n    (_b = window._oc_l10n_registry_plural_functions) === null || _b === void 0 ? true : delete _b[appId];\n}\n/**\n * Get translations bundle for given app and current locale\n *\n * @param {string} appId the app id\n * @return {object}\n */\nfunction getAppTranslations(appId) {\n    var _a, _b, _c, _d;\n    return {\n        translations: (_b = (_a = window._oc_l10n_registry_translations) === null || _a === void 0 ? void 0 : _a[appId]) !== null && _b !== void 0 ? _b : {},\n        pluralFunction: (_d = (_c = window._oc_l10n_registry_plural_functions) === null || _c === void 0 ? void 0 : _c[appId]) !== null && _d !== void 0 ? _d : ((number) => number),\n    };\n}\n\n/**\n * Translate a string\n *\n * @param {string} app the id of the app for which to translate the string\n * @param {string} text the string to translate\n * @param {object} vars map of placeholder key to value\n * @param {number} number to replace %n with\n * @param {object} [options] options object\n * @return {string}\n */\nfunction translate(app, text, vars, number, options) {\n    const defaultOptions = {\n        escape: true,\n        sanitize: true,\n    };\n    const allOptions = Object.assign({}, defaultOptions, options || {});\n    const identity = (value) => value;\n    const optSanitize = allOptions.sanitize ? DOMPurify.sanitize : identity;\n    const optEscape = allOptions.escape ? escapeHTML : identity;\n    // TODO: cache this function to avoid inline recreation\n    // of the same function over and over again in case\n    // translate() is used in a loop\n    const _build = (text, vars, number) => {\n        return text.replace(/%n/g, '' + number).replace(/{([^{}]*)}/g, (match, key) => {\n            if (vars === undefined || !(key in vars)) {\n                return optSanitize(match);\n            }\n            const r = vars[key];\n            if (typeof r === 'string' || typeof r === 'number') {\n                return optSanitize(optEscape(r));\n            }\n            else {\n                return optSanitize(match);\n            }\n        });\n    };\n    const bundle = getAppTranslations(app);\n    let translation = bundle.translations[text] || text;\n    translation = Array.isArray(translation) ? translation[0] : translation;\n    if (typeof vars === 'object' || number !== undefined) {\n        return optSanitize(_build(translation, vars, number));\n    }\n    else {\n        return optSanitize(translation);\n    }\n}\n/**\n * Translate a string containing an object which possibly requires a plural form\n *\n * @param {string} app the id of the app for which to translate the string\n * @param {string} textSingular the string to translate for exactly one object\n * @param {string} textPlural the string to translate for n objects\n * @param {number} number number to determine whether to use singular or plural\n * @param {object} vars of placeholder key to value\n * @param {object} options options object\n */\nfunction translatePlural(app, textSingular, textPlural, number, vars, options) {\n    const identifier = '_' + textSingular + '_::_' + textPlural + '_';\n    const bundle = getAppTranslations(app);\n    const value = bundle.translations[identifier];\n    if (typeof value !== 'undefined') {\n        const translation = value;\n        if (Array.isArray(translation)) {\n            const plural = bundle.pluralFunction(number);\n            return translate(app, translation[plural], vars, number, options);\n        }\n    }\n    if (number === 1) {\n        return translate(app, textSingular, vars, number, options);\n    }\n    else {\n        return translate(app, textPlural, vars, number, options);\n    }\n}\n/**\n * Load an app's translation bundle if not loaded already.\n *\n * @param {string} appName name of the app\n * @param {Function} callback callback to be called when\n * the translations are loaded\n * @return {Promise} promise\n */\nfunction loadTranslations(appName, callback) {\n    if (hasAppTranslations(appName) || getLocale() === 'en') {\n        return Promise.resolve().then(callback);\n    }\n    const url = generateFilePath(appName, 'l10n', getLocale() + '.json');\n    const promise = new Promise((resolve, reject) => {\n        const request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.onerror = () => {\n            reject(new Error(request.statusText || 'Network error'));\n        };\n        request.onload = () => {\n            if (request.status >= 200 && request.status < 300) {\n                try {\n                    const bundle = JSON.parse(request.responseText);\n                    if (typeof bundle.translations === 'object')\n                        resolve(bundle);\n                }\n                catch (error) {\n                    // error is probably a SyntaxError due to invalid response text, this is handled by next line\n                }\n                reject(new Error('Invalid content of translation bundle'));\n            }\n            else {\n                reject(new Error(request.statusText));\n            }\n        };\n        request.send();\n    });\n    // load JSON translation bundle per AJAX\n    return promise\n        .then((result) => {\n        register(appName, result.translations);\n        return result;\n    })\n        .then(callback);\n}\n/**\n * Register an app's translation bundle.\n *\n * @param {string} appName name of the app\n * @param {Object<string, string>} bundle translation bundle\n */\nfunction register(appName, bundle) {\n    registerAppTranslations(appName, bundle, getPlural);\n}\n/**\n * Unregister all translations of an app\n *\n * @param appName name of the app\n * @since 2.1.0\n */\nfunction unregister(appName) {\n    return unregisterAppTranslations(appName);\n}\n/**\n * Get array index of translations for a plural form\n *\n *\n * @param {number} number the number of elements\n * @return {number} 0 for the singular form(, 1 for the first plural form, ...)\n */\nfunction getPlural(number) {\n    let language = getLanguage();\n    if (language === 'pt-BR') {\n        // temporary set a locale for brazilian\n        language = 'xbr';\n    }\n    if (language.length > 3) {\n        language = language.substring(0, language.lastIndexOf('-'));\n    }\n    /*\n     * The plural rules are derived from code of the Zend Framework (2010-09-25),\n     * which is subject to the new BSD license (http://framework.zend.com/license/new-bsd).\n     * Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)\n     */\n    switch (language) {\n        case 'az':\n        case 'bo':\n        case 'dz':\n        case 'id':\n        case 'ja':\n        case 'jv':\n        case 'ka':\n        case 'km':\n        case 'kn':\n        case 'ko':\n        case 'ms':\n        case 'th':\n        case 'tr':\n        case 'vi':\n        case 'zh':\n            return 0;\n        case 'af':\n        case 'bn':\n        case 'bg':\n        case 'ca':\n        case 'da':\n        case 'de':\n        case 'el':\n        case 'en':\n        case 'eo':\n        case 'es':\n        case 'et':\n        case 'eu':\n        case 'fa':\n        case 'fi':\n        case 'fo':\n        case 'fur':\n        case 'fy':\n        case 'gl':\n        case 'gu':\n        case 'ha':\n        case 'he':\n        case 'hu':\n        case 'is':\n        case 'it':\n        case 'ku':\n        case 'lb':\n        case 'ml':\n        case 'mn':\n        case 'mr':\n        case 'nah':\n        case 'nb':\n        case 'ne':\n        case 'nl':\n        case 'nn':\n        case 'no':\n        case 'oc':\n        case 'om':\n        case 'or':\n        case 'pa':\n        case 'pap':\n        case 'ps':\n        case 'pt':\n        case 'so':\n        case 'sq':\n        case 'sv':\n        case 'sw':\n        case 'ta':\n        case 'te':\n        case 'tk':\n        case 'ur':\n        case 'zu':\n            return number === 1 ? 0 : 1;\n        case 'am':\n        case 'bh':\n        case 'fil':\n        case 'fr':\n        case 'gun':\n        case 'hi':\n        case 'hy':\n        case 'ln':\n        case 'mg':\n        case 'nso':\n        case 'xbr':\n        case 'ti':\n        case 'wa':\n            return number === 0 || number === 1 ? 0 : 1;\n        case 'be':\n        case 'bs':\n        case 'hr':\n        case 'ru':\n        case 'sh':\n        case 'sr':\n        case 'uk':\n            return number % 10 === 1 && number % 100 !== 11\n                ? 0\n                : number % 10 >= 2\n                    && number % 10 <= 4\n                    && (number % 100 < 10 || number % 100 >= 20)\n                    ? 1\n                    : 2;\n        case 'cs':\n        case 'sk':\n            return number === 1 ? 0 : number >= 2 && number <= 4 ? 1 : 2;\n        case 'ga':\n            return number === 1 ? 0 : number === 2 ? 1 : 2;\n        case 'lt':\n            return number % 10 === 1 && number % 100 !== 11\n                ? 0\n                : number % 10 >= 2 && (number % 100 < 10 || number % 100 >= 20)\n                    ? 1\n                    : 2;\n        case 'sl':\n            return number % 100 === 1\n                ? 0\n                : number % 100 === 2\n                    ? 1\n                    : number % 100 === 3 || number % 100 === 4\n                        ? 2\n                        : 3;\n        case 'mk':\n            return number % 10 === 1 ? 0 : 1;\n        case 'mt':\n            return number === 1\n                ? 0\n                : number === 0 || (number % 100 > 1 && number % 100 < 11)\n                    ? 1\n                    : number % 100 > 10 && number % 100 < 20\n                        ? 2\n                        : 3;\n        case 'lv':\n            return number === 0\n                ? 0\n                : number % 10 === 1 && number % 100 !== 11\n                    ? 1\n                    : 2;\n        case 'pl':\n            return number === 1\n                ? 0\n                : number % 10 >= 2\n                    && number % 10 <= 4\n                    && (number % 100 < 12 || number % 100 > 14)\n                    ? 1\n                    : 2;\n        case 'cy':\n            return number === 1\n                ? 0\n                : number === 2\n                    ? 1\n                    : number === 8 || number === 11\n                        ? 2\n                        : 3;\n        case 'ro':\n            return number === 1\n                ? 0\n                : number === 0 || (number % 100 > 0 && number % 100 < 20)\n                    ? 1\n                    : 2;\n        case 'ar':\n            return number === 0\n                ? 0\n                : number === 1\n                    ? 1\n                    : number === 2\n                        ? 2\n                        : number % 100 >= 3 && number % 100 <= 10\n                            ? 3\n                            : number % 100 >= 11 && number % 100 <= 99\n                                ? 4\n                                : 5;\n        default:\n            return 0;\n    }\n}\n\nexport { getCanonicalLocale, getDayNames, getDayNamesMin, getDayNamesShort, getFirstDay, getLanguage, getLocale, getMonthNames, getMonthNamesShort, getPlural, isRTL, loadTranslations, register, translate, translatePlural, unregister };\n","/**\n * @copyright Copyright (c) 2021 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author Christopher Ng <chrng8@gmail.com>\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { loadState } from '@nextcloud/initial-state'\nimport { translate as t, translatePlural as n } from '@nextcloud/l10n'\n\nimport '../css/public.css'\n\nimport { logger } from './logger.ts'\n\nconst { limit, downloads } = loadState('files_downloadlimit', 'download_limit', { limit: -1, downloads: 0 })\nlogger.debug('Download limit', { limit, downloads })\n\n// Global variables init on page load\nlet count = limit - downloads\nlet clicks = 0\n\n/**\n * Update the span counter message\n *\n * @param span html span element to update\n * @param count number of remaining downloads allowed\n */\nconst updateCounter = (span: HTMLSpanElement, count: number) => {\n\tif (count === 0) {\n\t\tspan.innerText = t('files_downloadlimit', 'You have reached the maximum amount of downloads allowed')\n\t} else {\n\t\tspan.innerText = n('files_downloadlimit', '1 remaining download allowed', '{count} remaining downloads allowed', count, { count })\n\t}\n}\n\nwindow.addEventListener('DOMContentLoaded', () => {\n\tif (limit < 1) {\n\t\treturn\n\t}\n\n\tconst container = document.getElementById('header-primary-action')\n\tif (!container) {\n\t\treturn\n\t}\n\n\tconst span = document.createElement('span')\n\tspan.setAttribute('style', 'color: var(--color-primary-text); padding: 0 10px;')\n\tupdateCounter(span, count)\n\tcontainer.prepend(span)\n\n\tconst publicContent = document.querySelector<HTMLElement>('#files-public-content')\n\tif (!publicContent) {\n\t\treturn\n\t}\n\n\t// Preventing mouse interaction\n\tpublicContent.oncontextmenu = (event) => {\n\t\tevent.preventDefault()\n\t\tevent.stopPropagation()\n\t\treturn false\n\t}\n\n\t// Adding double-download warning\n\tconst downloadButtons = document.querySelectorAll<HTMLAnchorElement>('a[href*=\"/download/\"]') || []\n\tnew Set(downloadButtons).forEach(button => {\n\t\tbutton.addEventListener('click', (event) => {\n\t\t\t// Warn about download limits\n\t\t\tif (clicks > 0) {\n\t\t\t\tif (!confirm(t('files_downloadlimit', 'This share has a limited number of downloads. Are you sure you want to trigger a new download?'))) {\n\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\tevent.stopPropagation()\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Handle counts changes\n\t\t\tcount--\n\t\t\tclicks++\n\t\t\tupdateCounter(span, count)\n\n\t\t\t// Remove the buttons if share is now expired\n\t\t\tif (count === 0) {\n\t\t\t\t[...downloadButtons].forEach(button => button.remove())\n\t\t\t}\n\t\t})\n\t})\n})\n"],"names":["matchHtmlRegExp","escapeHtml_1","escapeHtml","string","str","match","escape","html","index","lastIndex","loadState","app","key","fallback","elem","getAppTranslations","appId","_a","_b","_c","_d","number","translate","text","vars","options","allOptions","identity","value","optSanitize","DOMPurify","optEscape","escapeHTML","_build","r","translation","translatePlural","textSingular","textPlural","identifier","bundle","plural","limit","downloads","logger","count","clicks","updateCounter","span","t","n","container","publicContent","event","downloadButtons","button"],"mappings":"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","x_google_ignoreList":[0,1,2]}